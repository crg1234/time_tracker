 <div class="container-fluid">
   <a href="/projects/<%= @invoice.project_id %>"> <- Back to Project</a>

  <div class="row">

    <%= render 'shared/sidebarshowpages'%>

    <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
      <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-0 pb-2 mb-3 border-bottom">
        <div>
          <h1 class="h2">Invoice #<%= @project.id %></h1>
          <p>Project Name: <%= @project.name %></p>
          <p><i class="fa-regular fa-calendar"></i> &nbsp Date created: <%= @invoice.created_at.strftime("%d %B %Y")%></p>
          <p><i class="fa-regular fa-calendar"></i> &nbsp Payment Deadline: <%= @invoice.payment_deadline.strftime("%d %B %Y") %></p>
        </div>
        <div>
          <div class="btn-toolbar mb-2 mb-md-0 d-flex justify-content-end">
            <div class="btn-group me-2">
              <%= link_to invoice_path(@invoice, format: :pdf), :class => "btn btn-outline-secondary" do %>
              <i class="fa-regular fa-file-pdf fa-lg"></i><span> PDF</span>
              <% end %>
            </div>

            <div class="btn-group me-2">>
              <%# <%= simple_form_for(@invoice) do |f| %>
              <%# <% f.input :status, :value => invoice.update_invoice %>
              <%# <%= f.submit class: "btn-group me-2" %>
              <%# <% end %>
              <%= link_to update_status_path(@invoice), class: "btn btn-outline-secondary" do %>
              <i class="fa-solid fa-check fa-lg"></i><span> Mark as paid</span>
              <% end %>
            </div>

          </div>
        </div>
      </div>
      <div class="border-bottom mb-3 d-flex justify-content-between align-items-top">
        <div>
          <p>From: <%= @user.first_name %> <%= @user.last_name %></p>
          <p><%= @user.email %></p>
          <p>Bank: <%= @user.bank_name %></p>
          <p>Number account: <%= @user.bank_account_number %></p>
          <p>IBAN: <%= @user.bank_iban %></p>
        </div>
        <div>
          <p>To:&nbsp<%= @client.company_name %></p>
          <p><%= @client.first_name %> <%= @client.last_name %></p>
          <p><%= @client.email %></p>
          <%# <p>
          <%= @client.billing_address %>
          <%# </p> %>
        </div>
      </div>
      <div>
        <ul style="padding: 0; list-style: none;" class="border-bottom">
          <% @tasks.each do |task| %>
            <li>
              <div class="card-invoice-task d-flex justify-content-between align-items-center">
                <div class="card-invoice-task-info">
                  <h2><%= task.title %></h2>
                </div>
                <div>
                  <p>€<%= task.billing_rate ? task.billing_rate.round(2) : "€0" %>&nbsp per hour</p>
                  <p>Time spent: <%= task.time_log ? Time.at(task.time_log/1000).utc.strftime("%H:%M:%S") : "00:00:00" %></p>
                  <p>Total: €<%= task.amount_to_bill ? task.amount_to_bill.round(2) : "0.00" %></p>
                </div>
              </div>
            </li>
          <% end %>
        </ul>
      </div>
      <div class="d-flex align-items-right justify-content-end">
        <div>
          <h1> Total: €<%= @invoice.total_billing_amount ? @invoice.total_billing_amount.round(2) : "0" %></h1>
          <p>Total Time spent: <%= @invoice.total_time_amount ? Time.at(@invoice.total_time_amount / 1000).utc.strftime("%H:%M:%S") : "00:00:00" %></p>
        </div>
      </div>
    </main>
  </div>
</div>
