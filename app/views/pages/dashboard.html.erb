<div class="container-fluid">

  <div class="modal fade" id="addPopUp" tabindex="-1" aria-labelledby="addPopUpLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Add Client</h1>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="rounded p-1 w-100">
            <%= simple_form_for @client do |f| %>
                <%= f.input :first_name %>
                <%= f.input :last_name %>
                <%= f.input :company_name %>
                <%= f.input :email %>
                <%= f.input :phone_number %>
                <%= f.input :billing_address %>
                <%= f.submit class: "btn btn-outline-secondary" %>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


  <div class="row">
    <%= render 'shared/sidebar'%>


    <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 bg-our-dark-grey"><div class="chartjs-size-monitor"><div class="chartjs-size-monitor-expand"><div class=""></div></div><div class="chartjs-size-monitor-shrink"><div class=""></div></div></div>

      <div class="tab-content" id="tabContent">

        <div class="tab-pane show <%="active" unless params.has_key?(:tab)%>" id="home" role="tabpanel" aria-labelledby="home-tab">

          <h1 class="mb-5 h2">Hi <%= current_user.first_name.capitalize %>, welcome to your Dashboard</h1>

            <div class="container d-flex">

              <div class="summary-card col-sm-6">
                <div id="summary-money-billed">
                  <h1>Total Billed: €<%= @total_billing_amount.round(0) %></h1>
                </div>

                <div id="summary-money-billed">
                  <h1>Payment Received: €<%= @total_billing_amount.round(0) %></h1>
                </div>

                <%# TODO: Update math on payments outstanding %>

                <div id="summary-money-billed">
                  <h1>Payments Outstanding: €<%= @total_billing_amount.round(0) - @total_billing_amount.round(0) %></h1>
                </div>
              </div>

              <div class="summary-card col-sm-6">
                <div id="invoices-sent">
                  <h1>Invoices Sent: <%= @count_invoices %></h1>
                </div>

                <div id="invoices-sent">
                  <h1>Invoices Paid: <%= @count_invoices %></h1>
                </div>

                <%# TODO: Update math on payments outstanding %>

                <div id="invoices-sent">
                  <h1>Unpaid Invoices: <%= @count_invoices - @count_invoices %></h1>
                </div>
              </div>

            </div>

            <div class="row my-5">
              <div id="summary-time-logged col-sm-12 text-center">
                <h1>Total Time Logged:</h1>
                 <p style="font-size: 200px; text-primary"><%= Time.at(@total_time_logged/1000).utc.strftime("%H:%M:%S") %></p>
              </div>
            </div>

        </div>

        <div class="tab-pane fade <%="active" if params[:tab] == "customers-tab" %>" id="customers" role="tabpanel" aria-labelledby="customers-tab">
          <div class="d-flex justify-content-between">
            <h1 class="mb-4">Your clients</h1>
            <div>
              <button type="button" class="btn btn-outline-secondary create-client-link " data-bs-toggle="modal" data-bs-target="#addPopUp" >
              <i class="fa-solid fa-plus fa-2xl" style="color: #c7c7c7;"></i>
              </button>
            </div>
          </div>
          <%= render 'clients', clients: @clients %>
        </div>

        <div class="tab-pane fade <%="active" if params[:tab] == "projects-tab" %>" id="projects" role="tabpanel" aria-labelledby="projects-tab">
          <h1 class="mb-4">Your Projects</h1>
          <%= render 'projects'%>
        </div>

        <div class="tab-pane fade <%="active" if params[:tab] == "invoices-tab" %>" id="invoices" role="tabpanel" aria-labelledby="invoices-tab">
          <h1 class="mb-4">Your Invoices</h1>
          <%= render 'invoices'%>
        </div>

      </div>
    </main>
  </div>
</div>
